<?xml version="1.0"?>
<launch>
  <arg name="robot_name"		default="iiwa"/>
  <arg name="device"			default="iiwa14"/>
  <arg name="hardware_interface"	default="PositionJointInterface"/>
  <arg name="trajectory"		default="true"/>
  <arg name="joint_state_frequency"	default="100"/>
  <arg name="robot_state_frequency"	default="100"/>

  <group ns="$(arg robot_name)">
    <!-- Setup list of controllers to be spawned -->
    <arg name ="controller_list" if="$(arg trajectory)"
	 value="$(arg hardware_interface)_trajectory_controller"/>
    <arg name ="controller_list" unless="$(arg trajectory)"
	 value="$(arg hardware_interface)_J1_controller
		$(arg hardware_interface)_J2_controller
		$(arg hardware_interface)_J3_controller
		$(arg hardware_interface)_J4_controller
		$(arg hardware_interface)_J5_controller
		$(arg hardware_interface)_J6_controller
		$(arg hardware_interface)_J7_controller"/>

    <!-- Setup parameters for joint_state_controller -->
    <rosparam file="$(find aist_control)/config/joint_state_controller.yaml"/>
    <param name ="joint_state_controller/publish_rate"
	   value="$(arg joint_state_frequency)"/>

    <!-- Setup parameters for IIWA controllers -->
    <rosparam file="$(find aist_control)/config/$(arg device)_controller.yaml"
	      subst_value="true"/>

    <!-- Spawn controllers -->
    <node name="controller_manager"
	  pkg ="controller_manager" type="controller_manager"
	  args="spawn joint_state_controller $(arg controller_list)"
	  respawn="false" output ="screen"/>

    <!-- Convert sensor_msgs::JointState to geometry_msgs::TransformStamped
	 using the parameter robot_description and publish to TF -->
    <node name="robot_state_publisher"
    	  pkg ="robot_state_publisher" type="robot_state_publisher" >
      <param name="publish_frequency" value="$(arg robot_state_frequency)"/>
    </node>
  </group>

</launch>
